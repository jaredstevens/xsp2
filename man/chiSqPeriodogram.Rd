% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/chiSqPeriodogram.R
\name{chiSqPeriodogram}
\alias{chiSqPeriodogram}
\title{Chi-Square Periodogram}
\usage{
chiSqPeriodogram(
  activityDF,
  periodRange = c(5, 35),
  res = 0.1,
  bin_minutes = 1
)
}
\arguments{
\item{activityDF}{A data frame containing a numeric \code{value} column with regularly binned activity values.}

\item{periodRange}{A numeric vector of length 2 indicating the minimum and maximum test periods (in hours).}

\item{res}{Numeric. Resolution of test periods in hours. Defaults to 0.1.}

\item{bin_minutes}{Numeric. Duration of each time bin in minutes. Defaults to 1.}
}
\value{
A data frame with columns:
\describe{
\item{testPeriod}{The test period in hours.}
\item{Qp.act}{The Qp statistic for each test period.}
\item{Qp.sig}{The 0.99 significance threshold for each period.}
}
}
\description{
This function calculates the chi-square Qp statistic for a range of test
periods using binned activity values. It returns both the Qp values and the
significance threshold at p = 0.01.
}
\details{
Computes a chi-square periodogram (Qp) across a range of test periods
for binned activity data. Useful for detecting rhythmicity in time-series data.
}
\note{
Based on code from the \pkg{xsp} package by Hitoshi Iuchi (2017), MIT License.
}
\examples{
# Simulate data with a 24-hour rhythm
bins_per_day <- 1440  # 1-min bins
n_days <- 10
t <- seq(0, n_days * 24, length.out = bins_per_day * n_days)
raw <- sin(2 * pi * t / 24) + rnorm(length(t), sd = 0.3)
counts <- round(pmax(raw, 0) * 10)
df <- data.frame(value = counts)
chiSqPeriodogram(df, periodRange = c(20, 28), res = 0.1, bin_minutes = 1)

}
